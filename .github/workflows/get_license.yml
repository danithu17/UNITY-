name: Get Unity License üîë

on: workflow_dispatch

jobs:
  activation:
    name: Generate .alf file via Docker üê≥
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate Activation File
        run: |
          # ‡∑Ä‡∑ê‡∂© ‡∂ö‡∂ª‡∂± folder ‡∂ë‡∂ö‡∂ß ‡∂Ö‡∑Ä‡∑É‡∂ª ‡∂Ø‡∑ì‡∂∏
          sudo chmod -R 777 $(pwd)
          
          # Docker ‡∂ë‡∂ö run ‡∂ö‡∂ª‡∂Ω‡∑è ‡∂∂‡∂Ω‡∑ô‡∂±‡∑ä .alf ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ñ‡∂Ø‡∑Ä‡∂±‡∑Ä‡∑è
          docker run --rm \
            -v "$(pwd):/project" \
            -e "HOME=/tmp" \
            unityci/editor:ubuntu-2022.3.0f1-base-3 \
            unity-editor \
              -batchmode \
              -nographics \
              -createManualActivationFile \
              -logfile /dev/stdout \
              -projectPath /project || true
          
          # ‡∂Ø‡∑ê‡∂±‡∑ä ‡∂∏‡∑î‡∑Ö‡∑î system ‡∂ë‡∂ö‡∑ö‡∂∏ ‡∂≠‡∑í‡∂∫‡∑ô‡∂± .alf files ‡∑Ñ‡∑ú‡∂∫‡∂Ω‡∑è ‡∂Ö‡∂¥‡∑ö current folder ‡∂ë‡∂ö‡∂ß ‡∂ö‡∑ú‡∂¥‡∑í ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è
          echo "Searching for .alf files..."
          find / -name "*.alf" 2>/dev/null -exec cp {} . \; || true
          
          # Permission ‡∂Ü‡∂∫‡∑ô‡∂≠‡∑ä ‡∑Ñ‡∂Ø‡∂±‡∑Ä‡∑è upload ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂¥‡∑î‡∑Ö‡∑î‡∑Ä‡∂±‡∑ä ‡∑Ä‡∑ô‡∂±‡∑ä‡∂±
          sudo chmod -R 777 .

      - name: Upload ALF
        uses: actions/upload-artifact@v4
        with:
          name: Unity-Activation-File
          # ‡∂Ø‡∑ê‡∂±‡∑ä ‡∂Ö‡∂¥‡∑í ‡∂ö‡∑ô‡∂Ω‡∑í‡∂±‡∑ä‡∂∏ ‡∂Ö‡∂¥‡∑ö folder ‡∂ë‡∂ö‡∑ö ‡∂≠‡∑í‡∂∫‡∑ô‡∂± ‡∂ï‡∂±‡∑ë‡∂∏ .alf ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂ú‡∂±‡∑ä‡∂±‡∑Ä‡∑è
          path: "./*.alf"
          if-no-files-found: error